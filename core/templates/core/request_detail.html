{% extends 'core/base.html' %}

{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow border-0 rounded-4 p-4">
                <h3 class="text-center text-primary fw-bold mb-4">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ</h3>

                {% if request_obj.images.exists %}
                <div id="requestImagesSlider" class="carousel slide mb-4 rounded overflow-hidden" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        {% for image in request_obj.images.all %}
                        <div class="carousel-item {% if forloop.first %}active{% endif %}">
                            <img src="{{ image.image.url }}" class="d-block w-100" style="height: 400px; object-fit: cover;" alt="ØµÙˆØ±Ø© Ù„Ù„Ø·Ù„Ø¨">
                        </div>
                        {% endfor %}
                    </div>
                    {% if request_obj.images.count > 1 %}
                    <button class="carousel-control-prev" type="button" data-bs-target="#requestImagesSlider" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#requestImagesSlider" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    </button>
                    {% endif %}
                </div>
                {% else %}
                <div class="alert alert-light text-center border mb-4">ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø±ÙÙ‚Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨</div>
                {% endif %}

                <ul class="list-group list-group-flush mb-4">
                    <li class="list-group-item py-3"><strong>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</strong> {{ request_obj.full_name }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ“ Ø§Ù„Ø¬ÙˆØ§Ù„:</strong> {{ request_obj.phone }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ“ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> {{ request_obj.city }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ˜ï¸ Ø§Ù„Ø­ÙŠ:</strong> {{ request_obj.district }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ“Œ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨:</strong> {{ request_obj.get_request_type_display }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ  Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±:</strong> {{ request_obj.get_property_type_display }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ“ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</strong> {{ request_obj.area_required }} Ù…Â²</li>
                    <li class="list-group-item py-3"><strong>ğŸ’° Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø³Ø¹Ø±:</strong> {{ request_obj.max_price|floatformat:0 }} Ø±ÙŠØ§Ù„</li>
                    <li class="list-group-item py-3"><strong>ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> {{ request_obj.get_payment_method_display }}</li>
                    <li class="list-group-item py-3"><strong>ğŸ“ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:</strong><br>{{ request_obj.details|default:"-"|linebreaksbr }}</li>
                    <li class="list-group-item py-3">
                        <strong>ğŸš¦ Ø§Ù„Ø­Ø§Ù„Ø©:</strong>
                        {% if request_obj.status == 'executed' %}
                            <span class="badge bg-success">âœ… ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°</span>
                            <br><small class="text-muted">Ø¨ÙˆØ§Ø³Ø·Ø©: {{ request_obj.execution.agent }}</small>
                        {% else %}
                            <span class="badge bg-warning text-dark">â³ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ø¹Ø¯</span>
                        {% endif %}
                    </li>
                </ul>

                <div class="text-center">
                    <a href="{% url 'customer_requests' %}" class="btn btn-outline-secondary rounded-pill px-4">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
